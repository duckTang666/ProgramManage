# æˆæœåˆ›å»ºæ—¶è‡ªåŠ¨åˆ›å»ºachievements_parentsè®°å½•

## ğŸ¯ æ–°å¢åŠŸèƒ½

ç°åœ¨æ¯æ¬¡åˆ›å»ºæˆæœæ—¶ï¼Œéƒ½ä¼šåœ¨`achievements_parents`è¡¨ä¸­åˆ›å»ºè‡³å°‘ä¸€è¡Œè®°å½•ï¼Œå³ä½¿æ²¡æœ‰é€‰æ‹©åä½œè€…ã€‚

## ğŸ“Š æ•°æ®ç»“æ„ç¤ºä¾‹

### æƒ…å†µ1ï¼šæœ‰åä½œè€…æ—¶
é€‰æ‹©2ä¸ªåä½œè€…ï¼Œä¼šåˆ›å»º2æ¡è®°å½•ï¼š
```sql
id | achievement_id                              | parent_id                                  | created_at
---|-------------------------------------------|--------------------------------------------|------------
 1 | 25d58413-2cb0-41d8-993c-505b84f62e42    | 31f21c59-f3c4-44c9-91e8-b72f8891bce7       | 2024-01-01 10:00:00
 2 | 25d58413-2cb0-41d8-993c-505b84f62e42    | another-user-uuid                             | 2024-01-01 10:00:00
```

### æƒ…å†µ2ï¼šæ— åä½œè€…æ—¶
æ²¡æœ‰é€‰æ‹©åä½œè€…ï¼Œä¼šåˆ›å»º1æ¡é»˜è®¤è®°å½•ï¼š
```sql
id | achievement_id                              | parent_id                                  | created_at
---|-------------------------------------------|--------------------------------------------|------------
 1 | 25d58413-2cb0-41d8-993c-505b84f62e42    | 31f21c59-f3c4-44c9-91e8-b72f8891bce7       | 2024-01-01 10:00:00
```

## ğŸ”§ ä»£ç å®ç°é€»è¾‘

### 1. æˆæœåˆ›å»ºæµç¨‹
```typescript
// åœ¨createAchievementæ–¹æ³•ä¸­
if (data) {
  let parentIdsToInsert: string[] = [];
  
  if (parents_ids && parents_ids.length > 0) {
    // æœ‰åä½œè€…ï¼šä½¿ç”¨é€‰ä¸­çš„åä½œè€…
    parentIdsToInsert = parents_ids;
  } else {
    // æ— åä½œè€…ï¼šä½¿ç”¨å›ºå®šçš„é»˜è®¤UUID
    parentIdsToInsert = ['31f21c59-f3c4-44c9-91e8-b72f8891bce7'];
  }
  
  await this.addAchievementParents(data.id, parentIdsToInsert);
}
```

### 2. æ•°æ®åº“æ’å…¥é€»è¾‘
```typescript
// åœ¨addAchievementParentsæ–¹æ³•ä¸­
const insertData = parentIds.map(parentId => ({
  achievement_id: achievementId,  // æˆæœUUID
  parent_id: parentId             // åä½œè€…UUIDæˆ–é»˜è®¤UUID
}));

await supabase
  .from('achievements_parents')
  .insert(insertData)
  .select('*')
  .order('id'); // æŒ‰è‡ªå¢IDæ’åº
```

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### 1. å¯åŠ¨åº”ç”¨å¹¶æ‰“å¼€æ§åˆ¶å°
```bash
npm run dev
# æ‰“å¼€ http://localhost:5173/#/project-intro
# æŒ‰F12æ‰“å¼€å¼€å‘è€…å·¥å…· â†’ Console
```

### 2. æµ‹è¯•æ— åä½œè€…åˆ›å»º
1. å¡«å†™æˆæœä¿¡æ¯ï¼ˆä¸é€‰æ‹©ä»»ä½•åä½œè€…ï¼‰
2. ç‚¹å‡»"å‘å¸ƒ"
3. è§‚å¯Ÿæ§åˆ¶å°è¾“å‡ºï¼š
```
ğŸ”— æ·»åŠ åä½œè€…å…³ç³» - æˆæœID: 25d58413-2cb0-41d8-993c-505b84f62e42
ğŸ”— æ·»åŠ åä½œè€…å…³ç³» - åä½œè€…IDåˆ—è¡¨: ["31f21c59-f3c4-44c9-91e8-b72f8891bce7"]
ğŸ”— æ·»åŠ åä½œè€…å…³ç³» - åä½œè€…æ•°é‡: 1
ğŸ“ å‡†å¤‡æ’å…¥achievements_parentsè¡¨çš„æ•°æ®:
ğŸ“ è®°å½•1: {
  achievement_id: "25d58413-2cb0-41d8-993c-505b84f62e42",
  parent_id: "31f21c59-f3c4-44c9-91e8-b72f8891bce7",
  created_at: "è‡ªåŠ¨ç”Ÿæˆ"
}
âœ… åä½œè€…å…³ç³»æ·»åŠ æˆåŠŸï¼Œæ’å…¥ç»“æœ:
âœ… æ’å…¥æˆåŠŸè®°å½•1: {
  id: 1,
  achievement_id: "25d58413-2cb0-41d8-993c-505b84f62e42",
  parent_id: "31f21c59-f3c4-44c9-91e8-b72f8891bce7",
  created_at: "2024-01-01T10:00:00.000Z"
}
```

### 3. æµ‹è¯•æœ‰åä½œè€…åˆ›å»º
1. å¡«å†™æˆæœä¿¡æ¯å¹¶é€‰æ‹©2-3ä¸ªåä½œè€…
2. ç‚¹å‡»"å‘å¸ƒ" 
3. è§‚å¯Ÿæ§åˆ¶å°è¾“å‡ºç±»ä¼¼ä¿¡æ¯ï¼Œä½†åä½œè€…æ•°é‡ä¸ºå®é™…é€‰æ‹©çš„æ•°é‡

### 4. éªŒè¯æ•°æ®åº“ç»“æœ
åœ¨Supabase SQLç¼–è¾‘å™¨æ‰§è¡Œï¼š
```sql
-- æŸ¥çœ‹æœ€æ–°çš„achievements_parentsè®°å½•
SELECT 
    id,
    achievement_id,
    parent_id,
    created_at,
    CASE 
        WHEN parent_id = '31f21c59-f3c4-44c9-91e8-b72f8891bce7' 
        THEN 'é»˜è®¤è®°å½•'
        ELSE 'åä½œè€…è®°å½•'
    END as record_type
FROM achievements_parents 
ORDER BY created_at DESC 
LIMIT 10;

-- éªŒè¯IDè‡ªå¢
SELECT id, 
       'ID ' || id || ' - ' || 
       CASE 
           WHEN id = 1 THEN 'ç¬¬ä¸€æ¡è®°å½•'
           WHEN id = LAG(id) OVER (ORDER BY id) + 1 THEN 'æ­£å¸¸é€’å¢'
           ELSE 'è·³è·ƒï¼Œä¸Šä¸€æ¡æ˜¯ ' || COALESCE(LAG(id) OVER (ORDER BY id), 'N/A')
       END as status
FROM achievements_parents 
ORDER BY id DESC 
LIMIT 10;
```

## ğŸ“‹ é¢„æœŸç»“æœ

### æ§åˆ¶å°è¾“å‡º
- âœ… æ˜¾ç¤ºæˆæœIDï¼ˆUUIDï¼‰
- âœ… æ˜¾ç¤ºåä½œè€…IDåˆ—è¡¨ï¼ˆåŒ…å«é»˜è®¤å€¼æˆ–å®é™…é€‰æ‹©çš„å€¼ï¼‰
- âœ… æ˜¾ç¤ºåä½œè€…æ•°é‡
- âœ… æ˜¾ç¤ºæ¯æ¡æ’å…¥è®°å½•çš„è¯¦ç»†ä¿¡æ¯
- âœ… æ˜¾ç¤ºæ•°æ®åº“è‡ªå¢IDï¼ˆ1, 2, 3...ï¼‰

### æ•°æ®åº“è®°å½•
- âœ… æ¯æ¬¡åˆ›å»ºæˆæœè‡³å°‘äº§ç”Ÿä¸€æ¡è®°å½•
- âœ… idåˆ—ä»1å¼€å§‹è‡ªåŠ¨é€’å¢
- âœ… achievement_idæ­£ç¡®å­˜å‚¨æˆæœUUID
- âœ… parent_idå­˜å‚¨åä½œè€…UUIDæˆ–é»˜è®¤UUID
- âœ… created_atè‡ªåŠ¨ç”Ÿæˆæ—¶é—´æˆ³

## ğŸ” é»˜è®¤UUIDè¯´æ˜

å½“æ²¡æœ‰é€‰æ‹©åä½œè€…æ—¶ä½¿ç”¨çš„é»˜è®¤UUIDï¼š
```
31f21c59-f3c4-44c9-91e8-b72f8891bce7
```

è¿™ä¸ªUUIDï¼š
- ä»£è¡¨"æ— åä½œè€…"çš„é»˜è®¤å€¼
- å¯ä»¥åœ¨åç»­æŸ¥è¯¢ä¸­ç”¨äºåŒºåˆ†æœ‰åä½œè€…å’Œæ— åä½œè€…çš„æˆæœ
- å¦‚æœéœ€è¦ä¿®æ”¹ï¼Œå¯ä»¥åœ¨ä»£ç ä¸­æ›´æ”¹è¿™ä¸ªé»˜è®¤å€¼

## ğŸ¯ åŠŸèƒ½ç¡®è®¤

ç°åœ¨æ¯æ¬¡åˆ›å»ºæˆæœéƒ½ä¼šï¼š
1. âœ… åœ¨achievementsè¡¨åˆ›å»ºä¸»è¦è®°å½•
2. âœ… åœ¨achievements_parentsè¡¨åˆ›å»ºå…³è”è®°å½•ï¼ˆè‡³å°‘1æ¡ï¼‰
3. âœ… è‡ªå¢IDä»1å¼€å§‹ï¼Œæ¯æ¬¡æ’å…¥é€’å¢1
4. âœ… æ­£ç¡®å­˜å‚¨achievement_idå’Œparent_id
5. âœ… è‡ªåŠ¨ç”Ÿæˆcreated_atæ—¶é—´æˆ³