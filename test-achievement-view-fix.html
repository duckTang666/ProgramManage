<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ•™å¸ˆç«¯æˆæœæŸ¥çœ‹é¡µé¢ - å­¦ç”Ÿå§“åæ˜¾ç¤ºä¿®å¤éªŒè¯</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f8f9fa;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .header {
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 16px;
            margin-bottom: 24px;
        }
        .success {
            color: #28a745;
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 12px 16px;
            border-radius: 6px;
            margin: 16px 0;
        }
        .info {
            color: #0c5460;
            background-color: #d1ecf1;
            border: 1px solid #bee5eb;
            padding: 12px 16px;
            border-radius: 6px;
            margin: 16px 0;
        }
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            padding: 16px;
            margin: 16px 0;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
        }
        .before-after {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .before, .after {
            border: 1px solid #dee2e6;
            border-radius: 6px;
            padding: 16px;
        }
        .before {
            border-color: #dc3545;
            background-color: #f8d7da;
        }
        .after {
            border-color: #28a745;
            background-color: #d4edda;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }
        th {
            background-color: #f8f9fa;
            font-weight: 600;
        }
        .test-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 16px 0;
        }
        .test-button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“ æ•™å¸ˆç«¯æˆæœæŸ¥çœ‹é¡µé¢ - å­¦ç”Ÿå§“åæ˜¾ç¤ºä¿®å¤</h1>
            <p>éªŒè¯æ•™å¸ˆç«¯æˆæœæŸ¥çœ‹é¡µé¢ä¸­æ˜¯å¦æ­£ç¡®æ˜¾ç¤ºå­¦ç”Ÿçš„çœŸå®å§“åï¼ˆfull_nameï¼‰è€Œä¸æ˜¯"æœªçŸ¥å­¦ç”Ÿ"</p>
        </div>

        <div class="success">
            <strong>âœ… ä¿®å¤å®Œæˆï¼</strong>
            <p>å­¦ç”Ÿå§“åæ˜¾ç¤ºé—®é¢˜å·²ç»ä¿®å¤ï¼Œç°åœ¨ä¼šæ­£ç¡®æ˜¾ç¤ºç”¨æˆ·è¡¨ä¸­çš„ full_name å­—æ®µã€‚</p>
        </div>

        <div class="info">
            <strong>ğŸ“‹ ä¿®å¤è¯¦æƒ…ï¼š</strong>
            <ul>
                <li>ä¿®å¤äº†æ•°æ®ç»“æ„è®¿é—®é”™è¯¯ï¼šä» <code>users?.full_name</code> æ”¹ä¸º <code>publisher?.full_name</code></li>
                <li>ä¿®å¤äº†æœç´¢ç­›é€‰é€»è¾‘ï¼šæ”¯æŒæŒ‰ full_name å’Œ username æœç´¢å­¦ç”Ÿ</li>
                <li>ä¿æŒäº†å›é€€æœºåˆ¶ï¼šå¦‚æœ full_name ä¸ºç©ºï¼Œåˆ™æ˜¾ç¤º username</li>
            </ul>
        </div>

        <div class="before-after">
            <div class="before">
                <h3>âŒ ä¿®å¤å‰ï¼ˆæ˜¾ç¤º"æœªçŸ¥å­¦ç”Ÿ"ï¼‰</h3>
                <div class="code-block">
{(achievement as any).users?.full_name || (achievement as any).users?.username || 'æœªçŸ¥å­¦ç”Ÿ'}
                </div>
                <p><strong>é—®é¢˜ï¼š</strong> æ•°æ®ç»“æ„é”™è¯¯ï¼Œusers å­—æ®µä¸å­˜åœ¨ï¼Œå®é™…æ•°æ®åœ¨ publisher å­—æ®µä¸­</p>
            </div>
            <div class="after">
                <h3>âœ… ä¿®å¤åï¼ˆæ˜¾ç¤ºçœŸå®å§“åï¼‰</h3>
                <div class="code-block">
{(achievement as any).publisher?.full_name || (achievement as any).publisher?.username || 'æœªçŸ¥å­¦ç”Ÿ'}
                </div>
                <p><strong>è§£å†³ï¼š</strong> æ­£ç¡®è®¿é—® publisher å­—æ®µï¼Œè·å–å­¦ç”Ÿçš„ full_name</p>
            </div>
        </div>

        <h2>ğŸ”§ æœç´¢ç­›é€‰é€»è¾‘ä¿®å¤</h2>
        <div class="code-block">
const matchesStudent = !searchFilters.student || 
  ((achievement as any).publisher?.full_name?.toLowerCase().includes(searchFilters.student.toLowerCase()) ||
   (achievement as any).publisher?.username?.toLowerCase().includes(searchFilters.student.toLowerCase()));
        </div>
        <p>ç°åœ¨æ”¯æŒæŒ‰å­¦ç”Ÿçš„çœŸå®å§“åæˆ–ç”¨æˆ·åè¿›è¡Œæœç´¢ç­›é€‰ã€‚</p>

        <h2>ğŸ“Š æ•°æ®åº“æŸ¥è¯¢ç¡®è®¤</h2>
        <p>AchievementService.getAchievementsByRole() æ–¹æ³•å·²æ­£ç¡®æŸ¥è¯¢ full_name å­—æ®µï¼š</p>
        <div class="code-block">
publisher:users!publisher_id (username, email, full_name)
        </div>

        <h2>ğŸ§ª æµ‹è¯•æ­¥éª¤</h2>
        <ol>
            <li>å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼š<code>npm run dev</code></li>
            <li>è®¿é—®æ•™å¸ˆç«¯æˆæœæŸ¥çœ‹é¡µé¢ï¼š<a href="http://localhost:5173/#/achievement-view" target="_blank">http://localhost:5173/#/achievement-view</a></li>
            <li>ç¡®è®¤å­¦ç”Ÿåˆ—æ˜¾ç¤ºçœŸå®å§“åè€Œä¸æ˜¯"æœªçŸ¥å­¦ç”Ÿ"</li>
            <li>æµ‹è¯•æœç´¢åŠŸèƒ½ï¼šè¾“å…¥å­¦ç”Ÿå§“åè¿›è¡Œæœç´¢</li>
            <li>æŸ¥çœ‹æˆæœè¯¦æƒ…é¡µï¼Œç¡®è®¤å‘å¸ƒè€…ä¿¡æ¯æ˜¾ç¤ºæ­£ç¡®</li>
        </ol>

        <button class="test-button" onclick="window.open('http://localhost:5173/#/achievement-view', '_blank')">
            ğŸš€ æ‰“å¼€æˆæœæŸ¥çœ‹é¡µé¢æµ‹è¯•
        </button>

        <h2>ğŸ“‹ é¢„æœŸç»“æœ</h2>
        <table>
            <thead>
                <tr>
                    <th>ä½ç½®</th>
                    <th>ä¿®å¤å‰</th>
                    <th>ä¿®å¤å</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>å­¦ç”Ÿåˆ—ï¼ˆåˆ—è¡¨é¡µï¼‰</td>
                    <td style="color: #dc3545;">æœªçŸ¥å­¦ç”Ÿ</td>
                    <td style="color: #28a745;">çœŸå®å§“å (full_name)</td>
                </tr>
                <tr>
                    <td>å‘å¸ƒå­¦ç”Ÿï¼ˆè¯¦æƒ…é¡µï¼‰</td>
                    <td style="color: #dc3545;">æœªçŸ¥å­¦ç”Ÿ</td>
                    <td style="color: #28a745;">çœŸå®å§“å (full_name)</td>
                </tr>
                <tr>
                    <td>å­¦ç”Ÿæœç´¢</td>
                    <td style="color: #dc3545;">æ— æ³•æŒ‰å§“åæœç´¢</td>
                    <td style="color: #28a745;">æ”¯æŒæŒ‰å§“åå’Œç”¨æˆ·åæœç´¢</td>
                </tr>
            </tbody>
        </table>

        <div class="info">
            <strong>ğŸ’¡ æç¤ºï¼š</strong>
            <p>å¦‚æœæŸäº›å­¦ç”Ÿä»ç„¶æ˜¾ç¤º"æœªçŸ¥å­¦ç”Ÿ"ï¼Œè¯·æ£€æŸ¥è¿™äº›å­¦ç”Ÿåœ¨ users è¡¨ä¸­æ˜¯å¦è®¾ç½®äº† full_name å­—æ®µã€‚</p>
        </div>
    </div>
</body>
</html>